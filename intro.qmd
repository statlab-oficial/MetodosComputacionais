# Motivação

A Estatística, além de lidar com modelos matemáticos rigorosos, também é permeada por situações em que a intuição humana falha de maneira sistemática. Um exemplo clássico é o **problema do aniversário**, que há décadas desperta curiosidade entre estudantes e pesquisadores.  

::: {.callout-tip title="Enuciado"}
*Em uma sala com $r$ pessoas, qual a probabilidade de que pelo menos duas delas compartilhem o mesmo aniversário?*  
:::

Um resultado surpreendente é: com apenas **23 pessoas** em uma sala, a probabilidade de que haja pelo menos uma coincidência de aniversários já é **superior a 50%**.  Esse resultado é tão interessante que pode ser uma porta de entrada natural para discutir a diferença entre **probabilidade teórica** e **evidência empírica obtida por simulação**.  


## Da teoria à simulação

Do ponto de vista teórico, a probabilidade de que todos os aniversários sejam distintos entre $r$ pessoas é  

$$\Pr(\text{todos distintos}) \;=\; \prod_{i=1}^{r-1} \frac{365-i}{365}
\;=\; \left(1 - \frac{1}{365}\right)\!\left(1 - \frac{2}{365}\right)\!\cdots\!\left(1 - \frac{r-1}{365}\right).$$  

Logo, a probabilidade de pelo menos uma coincidência é  

$$p_r = 1 - \Pr(\text{todos distintos}).$$  

Esse produto é conceitualmente claro, mas fica pouco manejável mentalmente para $k$ moderados. É aqui que a **simulação computacional** pode entrar como aliada didática e científica.


## Um atalho analítico útil

O produto acima admite uma **aproximação exponencial simples e acurada**, obtida tomando logaritmo e usando a expansão para argumentos pequenos:

$$\ln(1 - x) = -x + o(x), \quad (x \to 0). $$
Aplicando ao produto,

$$
\begin{aligned}
\ln\!\big(1 - p_r\big)
\;&=\;
\sum_{i=1}^{r-1} \ln\!\left(1 - \frac{i}{365}\right)\\
\;&\approx\;
-\,\sum_{i=1}^{r-1} \frac{i}{365}
\;=\;
-\,\frac{1 + 2 + \cdots + (r-1)}{365}
\;=\;
-\,\frac{r(r-1)}{2 \cdot 365}.\end{aligned}$$

Exponentiando e isolando $p_r$, obtemos a aproximação

$$
p_r \;\approx\; 1 - \exp\!\left\{-\,\frac{r(r-1)}{730}\right\}.
$$

Essa fórmula tem três virtudes didáticas:

1) **Clareza**: exibe explicitamente o papel do número de pares $\binom{r}{2}$.

2) **Rapidez**: permite cálculos aproximados para valores de $r$ de interesse.

3) **Boas aproximações** já para $r$ na casa das dezenas.

::: {.callout-warning title="Exemplo Rápido"}

- Para **23 pessoas**:  

$$p_{23}^{(\text{aprox})}
  \;=\;
  1 - \exp\!\left\{-\frac{23\cdot22}{730}\right\}
  \;=\;
  1 - \exp\!\{-0.69315\}
  \;\approx\; 0.500,$$

alinhando-se ao resultado clássico de que **23** pessoas já superam 50% de chance de coincidência.
::: 

## O papel da simulação

A simulação estatística permite reproduzir o experimento de forma empírica: sorteamos aleatoriamente dias de aniversário para os indivíduos e verificamos se há repetições. Repetindo o processo milhares de vezes, obtemos uma estimativa para a probabilidade de coincidência.  

Por exemplo, em **R**:  

```{r}
k <- 23
birthdays <- sample(1:365, k, replace = TRUE)
any(duplicated(birthdays))
```

Ao repetir esse procedimento muitas vezes (por exemplo, 10.000 simulações), podemos estimar a proporção de conjuntos com coincidência. Pela Lei dos Grandes Números, essa estimativa converge para o valor teórico de aproximadamente 0,507 quando $k=23$.

```{r}
set.seed(123) #reprodutibilidade

k <- 23
B <- 10000

acertos <- 0L
i <- 0L

repeat {
  i <- i + 1L
  bdays <- sample(1:365, k, replace = TRUE)
  acertos <- acertos + as.integer(any(duplicated(bdays)))
  if (i >= B) break
}

p_hat <- acertos / B
p_hat
```


## Atividade: Problema do Aniversário (22 jogadores)


Nesta motivação consideramos um exemplo discutido em @martins_learning_2018 que é o conhecido e amplamente divulgado problema do aniversário [ver, por exemplo, @falk_closer_2014]. @martins_learning_2018 segue o exemplo de @matthews_coincidences_1998, considerando duas equipes de futebol e, portanto, coincidências de aniversário entre 22 jogadores. @martins_learning_2018 afirma que um resultado positivo importante dessa atividade é a discussão que surgirá naturalmente entre os estudantes, com o professor atuando como mediador. Além disso, os estudantes adoram jogos e a descoberta prática, e a simulação facilita o engajamento nessas atividades, ao mesmo tempo que ilustra resultados que podem ser não intuitivos, bem como teoria geral, como a **Lei dos Grandes Números**.

Agora iremos considerar o seguinte problema:

**O problema:** Em uma partida de futebol, qual é a probabilidade de que pelo menos dois dos 22 jogadores façam aniversário no mesmo dia?

Em um pais chamado de país do futebol, o contexto é proposital: o futebol é popular e as probabilidades resultantes são contraintuitivas. Antes de qualquer cálculo, considere as hipóteses: (i) todos os 365 dias do ano são igualmente prováveis para qualquer aniversário; (ii) as datas de aniversário dos jogadores são independentes entre si.


**Objetivos**

- Estimar, via simulação, a probabilidade de coincidência de aniversários.\
- Relacionar frequência relativa, Lei dos Grandes Números e variação amostral.\
- Comparar o resultado exato e aproximado.\

**Hipóteses**

- 365 dias equiprováveis, datas independentes, ignorar bissexto/gêmeos.

**Materiais**

- R (ou Posit Cloud), roteiro com comandos `sample()`, `table()`, `mean()`.


## Exercícios

1) Determinar o menor número de pessoas que deve estar em uma sala para que se possa apostar, com mais de 50% de chance de ganhar, que entre elas existam pelo menos duas com o mesmo aniversário.

2) Determinar o menor número de outras pessoas que deve estar em uma sala com você para que se possa apostar, com mais de 50% de chance de ganhar, que pelo menos uma delas tenha o mesmo aniversário que o seu.
